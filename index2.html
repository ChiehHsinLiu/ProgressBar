<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Hello World</title>
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>



</head>

<body>
  <div id="root"></div>

  <script type="text/babel">

    class Second extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          percent: "0%",
          height: "22px"
        }
        this.change2 = this.change2.bind(this)
      }

      change2() {
        this.setState({
          percent: "100%"
        })
      }

      componentDidMount() {
        console.log('mount2')
        var h = document.getElementById("sec2")
        var s = (h.offsetHeight).toString() + "px"
        this.setState({
          height: s
        })
      }

      componentDidUpdate(prevProps, prevState, snapshot) {
        var h = document.getElementById("sec2")
        var s = (h.offsetHeight).toString() + "px"
        console.log('preH', prevState.height)
        console.log('newH', s)
        if (prevState.height !== s) {
          console.log('update2')
          this.setState({
            height: s
          })
        }
      }

      render() {
        return (
          <div>
            <div>
              <div className="progress-back" style={{ backgroundColor: "rgba(0,0,0,0.2)", width: "7px", height: this.state.height, borderRadius: "10px", float: "Left" }}>
                <div className="progress-bar" style={{ backgroundColor: "#fe5196", width: "100%", height: this.state.percent, borderRadius: "10px", float: "Left" }}>
                </div>
              </div>
              <div id="sec2">
                <div style={{ marginLeft: "20px" }}> Section1-2 </div>

                {this.props.state.percent === "100%" &&
                  <div style={{ marginLeft: "20px" }}> content1-2 </div>}
                {this.props.state.percent === "100%" &&
                  <button onClick={this.change2} style={{ marginLeft: "20px" }}> complete1-2 </button>}
              </div>
            </div>
          </div >
        )
      }
    }



    class Home extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          percent: "0%",
          height: "22px"
        }
        this.change = this.change.bind(this)
      }

      change() {
        this.setState({
          percent: "100%"
        })
      }

      componentDidMount() {
        console.log('mount1')
        var h = document.getElementById("sec1")
        var s = (h.offsetHeight).toString() + "px"
        this.setState({
          height: s
        })
      }

      render() {
        console.log('render1', this.state)
        return (
          <div>
            <div>
              <div id="bar1" className="progress-back" style={{ backgroundColor: "rgba(0,0,0,0.2)", width: "7px", height: this.state.height, borderRadius: "10px", float: "Left" }}>
                <div className="progress-bar" style={{ backgroundColor: "#fe5196", width: "100%", height: this.state.percent, borderRadius: "10px", float: "Left" }}>
                </div>
              </div>
              <div id="sec1">
                <div style={{ marginLeft: "20px" }}> Section1-1 </div>
                <div style={{ marginLeft: "20px" }}> content1-1 </div>
                <div style={{ marginLeft: "40px" }}> content1-1 </div>
                <button onClick={this.change} style={{ marginLeft: "20px" }}> complete1-1 </button>
              </div>
            </div >

            <Second state={this.state} />
          </div >
        )
      }
    }


    ReactDOM.render(<Home />, document.getElementById('root'))
  </script>

</body>

</html>